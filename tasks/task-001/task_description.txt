task: This time around, we're setting up user access on your app with Node along with Express. We’re talking account creation, logging back in later, or simply jumping into what you’ve built.
instructions: >-
Here's the breakdown:

1. Sign-Up (POST /api/auth/register)
If somebody joins without issues, we shoot back a 201 - so it's good to go - with their ID plus email.
The email should catch attention. If someone already has it, we'll return a 400 error right away.
Passwords must include some letters together with numbers. When they're too weak, expect a 400 error showing up.
2. Log-In (POST /api/auth/login)
We should check the message while making certain the password works.
If it runs fine, we shoot back a 200 - everything’s set - including accessToken, refreshToken, plus the user info.
Each time you sign in, pick up a fresh refresh token. At that moment, swap out the access token - this makes everything more secure.
If you attempt to log in five times plus it fails, we respond with a 429 - blocking access briefly.
3. User Profile (GET /api/me)
Go this way instead. This one works only if the auth header has an access token - say, Bearer .
Got a solid token? Pass the user’s ID with their email. Otherwise – shoot back a 401. Invalid one? No access.
4. Token Stuff
The access token should be a JSON Web Token with HS256 - put the user’s ID inside, also add their email plus when it expires.
The refresh token needs to be a random string of chars - fairly long - to help protect stuff.
To get a new token, make a POST request to /api/auth/refresh - include the old refresh token yet grab a brand-new one back. After that step, the prior token gets disabled instantly.
Log out (POST /api/auth/logout) deletes the refresh token – so it won't work anymore. Try it once more? Works just fine, no hiccups.
5. Privacy's Important
Keep passwords private - don’t send them, not even scrambled ones, when using APIs.
task_description: |
This is the spot you’ll see the code

1. server/src/auth/service.js – deals with user accounts, manages password actions, while taking care of tokens too.
2. server/src/auth/routes.js – this is how Express manages sign-ups, while handling logins, working on token updates, managing logout actions, or fetching user details.
3. server/src/middleware/rateLimit.js – here’s where login attempts get slowed down.
4. server/src/index.js – connects all parts at once.

Quick Tips:

1. Set databases aside for now. Rather, store users and tokens directly in memory - like in a list.
2. Keep passwords safe with hashing - go for bcrypt or argon2 when saving them. These options guard info from the start - going with one boosts long-term security - choose depending on your system - you can trust both.
3. To slow down logins, track failed tries - reset counter if access succeeds. Try IP monitoring or email logs as alternatives. Trigger 429 error once five failures pile up.
4. Use JWT HS256 instead. Keep the key in process.env.JWT_SECRET - also add a test version just in case.
5. Keep the code simple to understand. That way, when something goes wrong, it's quicker to spot. Add clear warnings or little tips - they guide you right. This cuts down on guesswork later.
difficulty: hard
category: Feature
tags: [node, express, auth]
parser_name: pytest