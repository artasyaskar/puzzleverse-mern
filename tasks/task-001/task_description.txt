task_description: |
  Task: Build a simple login for this starter app.

  Please make a small, clear auth flow on the server (Node + Express). Keep it easy to read and do only what is needed here.

  What must work (these are the things we check):
  - Register (POST /api/auth/register)
    - Creates a user and returns { id, email } with 201.
    - Email must be unique without caring about case (USER@x and user@x are the same). Duplicates return 400 with a helpful message.
    - Password must be at least 8 characters and include a letter and a number. Bad input returns 400.
  - Login (POST /api/auth/login)
    - Checks email and password (email match is case-insensitive).
    - On success returns { accessToken, refreshToken, user: { id, email } } with 200.
    - Important: every successful login must return a new refresh token (different from any previous one).
    - Has a simple rate limit: after 5 failed attempts, return 429 with a friendly message.
  - Me (GET /api/me)
    - Needs Authorization: Bearer <accessToken>.
    - Returns { id, email } when the token is valid. Otherwise 401.
  - Tokens
    - Access token is a JWT (3 parts) using HS256 and has sub, email, and an exp in the near future.
    - Refresh token is a long random string (hex-like).
    - Refresh (POST /api/auth/refresh) replaces the used refresh token with a new one. The old one cannot be used again.
    - Logout (POST /api/auth/logout) revokes the given refresh token. Calling it twice with the same token is still OK.
  - Privacy
    - Never return passwords or password hashes in any response.

  Notes (how you implement it):
  - Keep everything in memory (no database).
  - Hash passwords (e.g. bcrypt or argon2). Do not store plaintext.
  - Use a JWT secret (HS256). A default is fine for local runs.

difficulty: hard
category: Feature
tags: [node, express, auth]
parser_name: pytest
