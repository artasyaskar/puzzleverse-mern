task_description: |
  Task: Add due dates and an "overdue" view for tasks (PATCH /api/tasks/:id/due-date, GET /api/tasks/overdue)
  Instructions:
    So far, tasks in this API know about titles, descriptions, status, and
    archive state. That is enough for basic lists, but it does not say
    anything about **when** a task is supposed to be done.

    In this task you will introduce a simple due-date concept and a dedicated
    endpoint for fetching "overdue" tasks. The goal is not to build a full
    calendar system, just a light layer of time awareness that makes the API
    feel more realistic.

    1. Extend the Task model with a due date

      - In `backend/models/Task.js`, add a new field to the schema:

          dueDate: Date or null

        - Type: `Date`.
        - Default: `null`.

    2. New endpoint: set or clear the due date for a single task

      - HTTP method: `PATCH`
      - Route: `/api/tasks/:id/due-date`

      Request body:
        - JSON object with one field:

            {
              "dueDate": "2025-12-31T23:59:59.000Z"
            }

        - `dueDate` semantics:
          - When present and non-null, it must be a string that can be parsed
            as an ISO-8601 timestamp.
          - When explicitly set to `null`, it should **clear** the due date
            (set `dueDate` back to null in the database).

      Behaviour:
        - If `:id` is not a valid MongoDB ObjectId:
          - Return HTTP 400 with a JSON body containing a `message` field.

        - If `:id` is a valid ObjectId but no task with that id exists:
          - Return HTTP 404 with a JSON body containing a `message` field.

        - When `dueDate` is a non-null value that **cannot** be parsed into a
          valid JavaScript `Date`:
          - Return HTTP 400 with a JSON body containing a `message` field.

        - When `dueDate` is a valid ISO-8601 string:
          - Update the task’s `dueDate` field to the corresponding `Date`.
          - Return HTTP 200 with the updated task document as JSON.

        - When `dueDate` is explicitly `null` in the JSON body:
          - Update the task’s `dueDate` field to `null`.
          - Return HTTP 200 with the updated task document as JSON.

    3. New endpoint: fetch overdue tasks

      - HTTP method: `GET`
      - Route: `/api/tasks/overdue`

      Definition of "overdue" for this task:
        - `dueDate` is **not null**.
        - `dueDate` is **strictly earlier** than the current time.
        - Task is **not archived**.

      Behaviour:
        - The endpoint should return HTTP 200 and a JSON array of tasks that
          meet the criteria above.
        - Sorting: it is reasonable to return tasks ordered by `dueDate`
          ascending (earliest overdue tasks first).
        - This endpoint does **not** need to support pagination or extra
          filters.

    4. Implementation notes

      - Add the `dueDate` field to the Mongoose schema in
        `backend/models/Task.js` with a default of `null`.
      - Add a new controller function in `backend/controllers/taskController.js`
        (for example, `updateTaskDueDate`) to handle the
        `PATCH /api/tasks/:id/due-date` logic.
      - Add another controller function (for example, `getOverdueTasks`) to
        handle `GET /api/tasks/overdue`.
      - Wire both controllers into `backend/routes/tasks.js`:
        - `PATCH /api/tasks/:id/due-date`
        - `GET /api/tasks/overdue`
      - Reuse the existing patterns for id validation and error responses so
        the new endpoints feel consistent with the rest of the API.
      - You may assume the server’s clock is the single source of truth for the
        meaning of "now".

    5. How this will be tested

      - The tests will spin up MongoDB and the backend using a task-local
        `docker-compose.yaml` (as in earlier tasks).
      - They will:
        - Create tasks with and without due dates.
        - Set and clear due dates via the PATCH endpoint.
        - Call `GET /api/tasks/overdue` and check that only the expected tasks
          appear in the response.
        - Verify that invalid ids, invalid `dueDate` values, and missing
          fields yield 400/404 responses as appropriate.

    You can think of this task as giving the API just enough sense of time to
    answer the question: "What should we have finished by now, but haven’t?"
    It should be simple to use from a frontend and easy to reason about when
    reading the code.

difficulty: hard
category: Feature
tags: [node, express, mongodb, backend, scheduling]
parser_name: pytest
