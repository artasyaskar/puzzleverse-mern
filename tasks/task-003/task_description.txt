task: Improve Login Rate Limiter (Retry-After + Reset)
instructions: >-
  Add a Retry-After header when login gives 429 errors - reset counters right after
  Logged in properly. Pay attention only to the actions shown next.
task_description: |
  Sort out the login limit issue - include a wait time then clear it properly after.

  Here’s what needs to run - because we’re going to test it ourselves
  - When five tries fail, the sixth one comes back with 429 plus a Retry-After header
    with a whole count of seconds.
    A successful login wipes the slate clean on failed tries for that account, meaning the count starts over from zero because of this action
    new mistakes begin with fresh ground.
  - Regular flow shouldn't get stopped unless things go beyond set limits.
  - Around 429 replies came with a kind note - like saying they’re swamped.
  - Rate limits are set right, so signing in somewhere won't block access elsewhere
    other independent contexts.

  This is where you tweak stuff - spots you could check out
  - server/src/middleware/rateLimit.js – look at how much time is left in the cycle, after that either assign or show Retry-After.
  - server/src/auth/routes.js – when hitting 429, add Retry-After header; after recovery, clear counter immediately.
  - server/src/utils/http.js – just a tiny tool that tosses in default error messages or headers if needed, depending on the situation.

  Comments (don't count toward your grade):
  - Checks just need Retry-After to be a whole number of seconds; exact
    Timing during countdown isn't checked.
  - {"message": "Send answers in JSON format with useful info."}.
difficulty: hard
category: Feature
tags: [node, express, auth]
parser_name: pytest
