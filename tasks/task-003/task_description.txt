task: Improve Login Rate Limiter (Retry-After + Reset)
instructions: >-
  Set up the login rate limit to include a Retry-After header if it hits 429, then ensure replies come just after the wait time
  sure clear the wrong attempts counter when they log in okay. Keep an eye on the
  stuff listed under "What needs to function".
task_description: |
  Fix the login rate limiter - add retry-after plus reset logic.

  What needs to work – since we’ll check it on our own:
  - After five failed attempts, one more shot brings a 429 error - tacking on extra delay
  a Retry-After header with a digit that tells how many seconds.
  A login that works wipes the mistake count clean - so they get five fresh tries again
  chances till isolation starts again.
  Hot runs don’t need to shut anyone out.
  A 429 response should have a calm "too busy" message tucked in.
  Logging in here shouldn’t lock you out of there.

  Here's the spot to adjust things - places you might visit
  - server/src/middleware/rateLimit.js – check remaining time in window, then set or display Retry-After.
  - server/src/auth/routes.js – if you get 429, set Retry-After; once it works, reset the count right away.
  - server/src/utils/http.js – a small helper that adds standard error texts or headers when required, based on what's happening.

  Thoughts - won’t affect your score:
  The exact time might shift - tests only require an integer for Retry-After.
  {"message": "Send answers in JSON format with useful info."}.

difficulty: hard
category: Feature
tags: [node, express, auth]
parser_name: pytest
