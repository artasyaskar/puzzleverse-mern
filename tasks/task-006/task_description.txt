task: Refresh Token Cap and Hygiene
instructions: >-
  Lose the added refresh tokens per user - keep things lean
  tickets vanish fast. So keep spinning just to stay in the game.
task_description: |
  Count how many live refresh tokens someone holds. When the number climbs past the max, drop the oldest one hanging around. Keep things moving by swapping out outdated entries whenever needed.

  What needs to work - we'll try it out on our own
  Fake logins trigger unique reset keys.
  - POST /api/auth/refresh dumps the outdated token then returns a new one.
  Pick a cap - like five things each. When you reach it, get rid of the oldest one.
  Trying to refresh with an old short token brings up a 401 error instead.
  Changing via /refresh keeps the top tier - no increase beyond that point.
  - If a refresh token is taken away - like when someone logs out - the system gives a different one right after
  less tokens left over - from there, making a new one still stays within bounds even when applying the
  same basic trim method – holds onto latest pieces. Go with X-Refresh-Token-Count, otherwise skip it
  Show the new count instantly when something happens.
  You won't spot a refresh token anywhere - only inside the section marked refreshToken.
  - Responses from the login URL (/api/auth/login) or the refresh path (/api/auth/refresh) arrive with
  a new X-Refresh-Token-Count label that tells the remaining token count a user has
  When finished, add it up – should be above nothing but under the limit.

  Here's the place to make changes - areas you might adjust
  - server/src/auth/service.js – takes care of user tokens, applies caps, cuts extras now then.
  - server/src/index.js – still runs as before; display only if the test requires it.
  - server/src/utils/collections.js – useful tools such as size-limited queues, when you happen to need them.

  Keep in mind – these don’t affect your score
  Keep info inside - no need to log token digits.

difficulty: hard
category: Feature
tags: [node, express, auth]
parser_name: pytest
